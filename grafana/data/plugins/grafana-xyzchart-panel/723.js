"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[723],{723:(e,t,r)=>{r.r(t),r.d(t,{default:()=>S});var n=r(160),o=r(236),a=r(650),l=r.n(a),i=r(545),s=r(742),c=r(649),u=r(154);const p=()=>{const{camera:e,gl:t}=(0,i.Ky)(),r=u.N1;let n,o;return n=[1.4*r,r-r/2,1.4*r],o=[0,0,0],(0,a.useEffect)((()=>{let a=null;return a=new c.z(e,t.domElement),a.minDistance=3,a.maxDistance=2*r,e.position.set(...n),a.target.set(...o),a.update(),()=>{null!==a&&a.dispose()}}),[e,t,r]),l().createElement(s.c,{fov:75})};var m=r(886);const d=l().createContext({pointColor:"",pointSize:0,seriesMapping:"auto"}),h=d.Provider,f=d;var g=r(173),b=r(508),E=r(120);const v=e=>{const{pointVector:t}=e,r=(0,a.useContext)(f),n=new g.Vector3(t.x,t.y,0),o=new g.Vector3(0,t.y,t.z),i=new g.Vector3(t.x,0,t.z);return l().createElement(l().Fragment,null,l().createElement(E.x,{points:[t,n],color:r.themeColor,dashed:!0}),l().createElement(E.x,{points:[t,o],color:r.themeColor,dashed:!0}),l().createElement(E.x,{points:[t,i],color:r.themeColor,dashed:!0}))};var N=r(644);const x=({pointPos:e,xValue:t,yValue:r,zValue:n})=>{const i=(0,a.useContext)(f),s=y(i);return l().createElement(o.V,{position:e,style:{transform:"translate3d(-50%, -120%, 0)"}},l().createElement("div",{className:s.tooltip},l().createElement("ul",null,l().createElement("li",null,t),l().createElement("li",null,r),l().createElement("li",null,n))))},y=e=>({tooltip:N.css`
      padding: 10px;
      background-color: ${e.hudBgColor};
      text-align: left;
      color: white;
      ul {
        list-style: none;
        display: inline-block;
        li {
          white-space: nowrap;
        }
      }
    `}),C=({points:e,lights:t,frames:r})=>{const n={geometry:new g.BufferGeometry},o=new g.PointsMaterial,i=(0,a.useRef)(n),s=(0,a.useRef)(o),c=(0,a.useContext)(f),u=(0,b.m)("/public/plugins/grafana-xyzchart-panel/img/dot.png"),[p,d]=(0,a.useState)(null),[h,E]=(0,a.useState)([]);(0,a.useEffect)((()=>{var e;const t=(0,m.oo)(null!==(e=c.pointColor)&&void 0!==e?e:"#ff0000"),r=i.current.geometry.getAttribute("color");for(let e=0;e<r.array.length;e++)r.setXYZ(e,t.r,t.g,t.b),r.needsUpdate=!0}),[c.pointColor]),(0,a.useEffect)((()=>{s.current&&(s.current.size=c.pointSize,s.current.needsUpdate=!0)}),[c.pointSize]),(0,a.useEffect)((()=>{if(i.current){const t=new g.BufferAttribute(e.points,3),r=new g.BufferAttribute(e.colors,3);i.current.geometry.setAttribute("position",t),i.current.geometry.setAttribute("color",r),i.current.geometry.attributes.position.needsUpdate=!0}}),[e]);const N=(0,a.useCallback)((e=>{e.stopPropagation();const t=i.current.geometry.getAttribute("color");t.setXYZ(e.index,1,1,1),t.needsUpdate=!0,i.current.geometry.setAttribute("color",t);let n=[];for(let t of r[0].fields)n.push(`${t.name}: ${t.values.get(e.index)}`);E(n);const o=i.current.geometry.getAttribute("position"),a=new g.Vector3(o.getX(e.index),o.getY(e.index),o.getZ(e.index));d(a)}),[r]),y=(0,a.useCallback)((e=>{var t;e.stopPropagation();const r=(0,m.oo)(null!==(t=c.pointColor)&&void 0!==t?t:"#ff0000"),n=i.current.geometry.getAttribute("color");n.setXYZ(e.index,r.r,r.g,r.b),n.needsUpdate=!0,i.current.geometry.setAttribute("color",n),E([]),d(null)}),[c.pointColor]);return l().createElement(l().Fragment,null,l().createElement("points",{ref:i,onPointerOver:N,onPointerOut:y},l().createElement("bufferGeometry",{attach:"geometry"},l().createElement("bufferAttribute",{attachObject:["attributes","position"],count:e.points.length/3,array:e.points,itemSize:3}),l().createElement("bufferAttribute",{attachObject:["attributes","color"],count:e.colors.length/3,array:e.colors,itemSize:3})),l().createElement("pointsMaterial",{ref:s,attach:"material",opacity:1,transparent:!0,vertexColors:!0,size:c.pointSize,sizeAttenuation:!0,map:u})),null!==p&&l().createElement(l().Fragment,null,l().createElement(v,{pointVector:p}),l().createElement(x,{pointPos:p,xValue:h[0],yValue:h[1],zValue:h[2]})))};var w;!function(e){e[e.Up=1]="Up",e[e.Right=2]="Right",e[e.Forward=3]="Forward"}(w||(w={}));var k=r(578);const z=({direction:e,labelSize:t,position:r,rotation:n,text:o})=>{const i=(0,a.useContext)(f),s=t||.2*u.N1/10;var c;const p=null!==(c=i.themeColor)&&void 0!==c?c:u.Cj,m=e===w.Right?"116%":-1.15;return l().createElement(k.x,{color:p,textAlign:"left",anchorX:m,fontSize:s,position:r,rotation:n},o)},A=({direction:e,intervalLabels:t})=>{const r=(0,a.useContext)(f),n=(0,a.useCallback)((e=>{let t,n,o=[0,0,0];const a=[],l=[];var i;const s=null!==(i=r.themeColor)&&void 0!==i?i:u.Cj;switch(e){case w.Up:t=[u.N1,0,0],n=[u.N1,u.N1,0];break;case w.Forward:t=[u.N1,0,0],n=[u.N1,0,u.N1];break;case w.Right:t=[0,0,u.N1],n=[u.N1,0,u.N1]}for(let t=0;t<u.N1+u.BN;t+=u.BN)switch(e){case w.Up:a.push([[u.N1,t,0],[u.N1+u._j*u.N1/10,t,0]]),0===t?l.push([u.N1+u.c0,t+.5,-1]):l.push([u.N1+u.c0,t,0]);break;case w.Forward:a.push([[u.N1,0,t],[u.N1+u._j*u.N1/10,0,t]]),0===t?l.push([u.N1+u.c0,-.5,t+1]):l.push([u.N1+u.c0,0,t]),o=[-Math.PI/2,0,0];break;case w.Right:a.push([[t,0,u.N1],[t,0,u.N1+u._j*u.N1/10]]),l.push([t,0,u.N1+u.c0]),o=[-Math.PI/2,0,Math.PI/2]}return{axisPoints:[t,n],intervalGeometries:a,intervalLabelPos:l,labelRotation:o,color:s}}),[r.themeColor]),{axisPoints:o,intervalGeometries:i,intervalLabelPos:s,labelRotation:c,color:p}=(0,a.useMemo)((()=>n(e)),[e,n]);return l().createElement("group",{key:"axis_"+e},l().createElement(E.x,{points:o,color:p,lineWidth:2.5,dashed:!1}),i.map(((r,n)=>l().createElement("group",{key:n},l().createElement(E.x,{points:r,color:p,lineWidth:2.5,dashed:!1}),l().createElement(z,{direction:e,position:s[n],text:t[n],rotation:c})))))},P=({direction:e,intervalLabels:t})=>{const r=(0,a.useMemo)((()=>(e=>{let t=[];for(let r=0;r<u.N1;r+=u.BN)switch(e){case w.Up:t.push([[r,0,0],[r,u.N1,0]]),t.push([[0,r,0],[u.N1,r,0]]);break;case w.Right:t.push([[0,0,r],[u.N1,0,r]]),t.push([[r,0,0],[r,0,u.N1]]);break;case w.Forward:t.push([[0,r,0],[0,r,u.N1]]),t.push([[0,0,r],[0,u.N1,r]])}return t})(e)),[e]);return l().createElement("group",null,r.map(((e,t)=>l().createElement(E.x,{points:e,color:u.Zc,key:t,lineWidth:.5}))),l().createElement(A,{direction:e,intervalLabels:t}))},L=({intervalLabels:e})=>l().createElement("group",null,l().createElement(P,{direction:w.Up,intervalLabels:e.yLabels}),l().createElement(P,{direction:w.Right,intervalLabels:e.xLabels}),l().createElement(P,{direction:w.Forward,intervalLabels:e.zLabels})),S=({frames:e,options:t})=>{let r=(0,a.createRef)(),s=(0,a.createRef)();var c;const[d,f]=(0,a.useState)((0,m.aA)(e,null!==(c=t.pointColor)&&void 0!==c?c:"#ff0000")),[g,b]=(0,a.useState)((0,m.pw)(e));function E(){const{progress:e}=(0,n.S)();return l().createElement(o.V,{center:!0},e," % loaded")}return(0,a.useEffect)((()=>{const r=(0,m.pw)(e);var n;b(r),f((0,m.aA)(e,null!==(n=t.pointColor)&&void 0!==n?n:"#ff0000"))}),[e]),l().createElement(l().Fragment,null,l().createElement(i.Xz,{mode:"concurrent",raycaster:{params:{Points:{threshold:2}}},linear:!0,flat:!0},l().createElement(a.Suspense,{fallback:l().createElement(E,null)},l().createElement(h,{value:t},l().createElement(p,null),l().createElement("ambientLight",{ref:r,intensity:.8,color:u.Cj}),l().createElement("pointLight",{ref:s,intensity:1,position:[10,10,10]}),l().createElement(a.Suspense,{fallback:null},l().createElement(C,{frames:e,points:d,lights:[r,s]})),l().createElement(L,{intervalLabels:g})))))}}}]);
//# sourceMappingURL=723.js.map